[
  {"op": "remove", "path": "/machine/network"},
  {"op": "add", "path": "/machine/network", "value":
    {
      "hostname": "ZZ_HOSTNAME",
      "interfaces": [
        {
          "interface": "eth0",
          "dhcp": true,
          "mtu": 1500,
          "vip": {
            "ip": "10.0.40.32"
          }
        }
      ],
      "extraHostEntries": [
        {
          "ip": "10.0.40.32",
          "aliases": [
            "main.zinn.ca"
          ]
        }
      ]
    }
  },
  {"op": "replace", "path": "/machine/time", "value":
    {
      "disabled": false,
      "servers": [
        "time.cloudflare.com"
      ]
    }
  },
  {"op": "add", "path": "/machine/kubelet/extraArgs", "value":
    {
      "feature-gates": "GracefulNodeShutdown=true,MixedProtocolLBService=true",
      "rotate-server-certificates": true
    }
  },
  {"op": "add", "path": "/machine/extraKernelArgs", "value": [
    "talos.logging.kernel=udp://10.0.40.38:6001/"
  ]},
  {"op": "add", "path": "/machine/logging", "value":
    {
      "destinations": [
        {
          "endpoint": "udp://10.0.40.38:6002/",
          "format": "json_lines"
        }
      ]
    }
  },
  {"op": "add", "path": "/cluster/apiServer/extraArgs", "value":
    {
      "feature-gates": "GracefulNodeShutdown=true,MixedProtocolLBService=true"
    }
  },
{"op": "add", "path": "/cluster/proxy/disabled", "value": true },
  {"op": "add", "path": "/cluster/network/cni", "value":
    {
      "name": "custom",
      "urls": [
        "http://router/main-cilium-quick-install.yaml"
      ]
    }
  },
  {"op": "add", "path": "/cluster/controllerManager/extraArgs", "value":
    {
      "bind-address": "0.0.0.0"
    }
  },
  {"op": "add", "path": "/cluster/scheduler/extraArgs", "value":
    {
      "bind-address": "0.0.0.0"
    }
  },
  {"op": "replace", "path": "/cluster/extraManifests", "value":[
    "https://raw.githubusercontent.com/alex1989hu/kubelet-serving-cert-approver/v0.3.0/deploy/ha-install.yaml"
  ]},
  {"op": "replace", "path": "/cluster/network/podSubnets/0", "value": "10.40.0.0/16"},
  {"op": "replace", "path": "/cluster/network/serviceSubnets/0", "value": "10.41.0.0/16"}
]
